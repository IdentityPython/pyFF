<!DOCTYPE html>
## -*- coding: utf-8 -*-
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="/static/bootstrap/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="/static/css/typeaheadjs.css" rel="stylesheet"/>
    <link href="/static/css/pyff.css" rel="stylesheet"/>
    <link href="/static/css/ds.css" rel="stylesheet"/>
    <link href="/static/css/style.css" rel="stylesheet"/>
    <script type="text/javascript" src="/static/js/jquery.min.js"></script>
    <script type="text/javascript" src="/static/bootstrap/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="/static/js/jquery.browser.js"></script>
    <script type="text/javascript" src="/static/js/jquery.ba-bbq.min.js"></script>
    <script type="text/javascript" src="/static/js/hogan.js"></script>
    <script type="text/javascript" src="/static/js/typeahead.bundle.min.js"></script>
    <script type="text/javascript" src="/static/js/json2.js"></script>
    <script type="text/javascript" src="/static/js/jstorage.js"></script>
    <!-- script type="text/javascript" src="/static/js/sha1.js"></script -->
    <script type="text/javascript" src="/static/js/tinySHA1.r4.js"></script>
    <script type="text/javascript" src="/static/js/pyff.js"></script>
    <script type="text/javascript">
        $(function() {
            $("*[data-toggle='popover']").popover({trigger: 'hover'});
            $("*[data-toggle='popover']").on('show.bs.popover', function() {
                $(this).delay(500).popover('hide');
            });
            $('#quickLinks').dsQuickLinks('${sp}');
            $('.sp').dsRelyingParty('${sp}');
            $('.idselect').dsSelect({});
            jQuery.fn.sort = function() {
                return this.pushStack( [].sort.apply( this, arguments ), []);
            };
            $('.message > button.close').click(function(e) {
                //console.log(e);
                //console.log($(this));
                var closed = $.jStorage.get('pyff.discovery.messages',{});
                var id = $(this).parentsUntil('.message').attr('id');
                $(this).parent().each(function() {
                    //console.log($(this).attr('id'));
                    closed[$(this).attr('id')] = true;
                });
                $.jStorage.set('pyff.discovery.messages',closed);
            });
            $('.message').each(function () {
                var closed = $.jStorage.get('pyff.discovery.messages',{});
                if (closed[$(this).attr('id')]) {
                    $(this).hide();
                }
            });
            $('#to_list').click(function(){
                $('#thelist').dsSelect('refresh');
                $('#thelist').removeClass('hidden');
                $('#thesearch').addClass('hidden');
                $('#to_list').addClass('hidden');
                $('#to_search').removeClass('hidden');
                // $('#thelist').focus(); // consider this some more - it may be better to ask the user to click...
            });
            $('#to_search').click(function() {
                $('#thesearch').removeClass('hidden');
                $('#thelist').addClass('hidden');
                $('#to_search').addClass('hidden');
                $('#to_list').removeClass('hidden');
                //$('#thesearchfield').focus();
            });
            $('#thesearchfield').focus();
        });
    </script>
    <title>Please login...</title>
<body>
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="/static/js/html5shiv.js"></script>
      <script src="/static/js/respond.min.js"></script>
    <![endif]-->
    <div class="container">
        <div class="header text-muted">
            <div class="row">
                <div class="col-sm-10">
                    <small>${_('Select a login provider for ...')}</small>
                    <h3><span class="sp sp-name"></span></h3>
                </div>
                <div class="col-sm-2 pull-right hidden-xs"><img class="sp sp-icon sp-thumbnail fallback-icon"/></div>
            </div>
            <small class="pull-right"><a class="sp sp-privacy-statement-url" title="Privacy Statement"></a></small>
            <div class="clearfix"></div>
        </div>

        <div id="content" class="idpchooser">
            <div id="quickLinks"
                 data-target="/metadata/{http:%2F%2Fpyff-project.org/domain}${entity['domains']}+{http:%2F%2Fpyff-project.org/role}idp.json"></div>
            <form role="search">
                <div class="form-group">
                    <div id="thesearch"><input type="text"
                           class="form-control idselect"
                           id="thesearchfield"
                           data-target="${search}"
                           data-related="${entity['domains']}"
                           placeholder="${_('Start typing to search for your login provider...')}"/></div>
                    <select title="${_('Select your login provider ...')}"
                            id="thelist"
                            class="form-control idselect hidden">
                    </select>
                    <small class="pull-right">
                        <a href="#" id="to_list">... ${_('let me choose from a list instead')}</a>
                        <a href="#" class="hidden" id="to_search">... ${_('let me search instead')}</a>
                    </small>
                </div>
            </form>
        </div>
        <div class="hidden" id="remember-selection-dlg">
            <div class="list-group confirm"></div>
            <div class="btn-block">
                <a id="proceed" class="btn btn-large btn-primary proceed btn-responsive">${_('Proceed to Login')}</a>
                <a id="remember" class="btn btn-large btn-warning remember btn-responsive" data-toggle="popover" data-placement="bottom" title="What is this?" data-content="${_('Select this option if you always use one and the same login provider for everything.')}">${_('Login and use Forever')}</a>
                <a id="proceed_and_remember" class="btn btn-large btn-success hidden proceed_and_remember btn-responsive">${_('Yes I am Sure - Use Forever')}</a>
                <a id="cancel" class="btn btn-large btn-default cancel btn-responsive" data-toggle="popover" data-placement="bottom" title="What is this?" data-content="${_('Click here to start over and select another login provider.')}">${_('Select Again')}</a>
            </div>
        </div>
        <div class="footer">
            <small id="reset_info" class="hidden">
                <i class="glyphicon glyphicon-exclamation-sign"></i> If you change your mind, visit <a href="${http.base}/reset">${http.base}/reset</a> to change your settings.
            </small>
        </div>
    </div>
</body>
</html>
